# mcubed-lineup-insight-server

Description
----
A node module that caches and serves fantasy sports data.

[mcubed-lineup-insight-data](https://github.com/nickp10/mcubed-lineup-insight-data) vs. [mcubed-lineup-insight-server](https://github.com/nickp10/mcubed-lineup-insight-server)
----
mcubed-lineup-insight-server is a node module that relies on mcubed-lineup-insight-data for all of its data. The data module is used for retrieving the fantasy sports data from third-parties. The server module is used for aggregating the data for all the current contests and merging the data from the different third-parties into the contests.

Features
----
* The ability to serve fantasy sports data over HTTP
* The ability to cache fantasy sports data for quick response times
* The ability to aggregate fantasy sports data from multiple sources/sports into one response
* The ability to merge fantasy sports data for the same entity (player, team, contest, etc.)

Command Line Interface
----
This node module is only usable from the command line using `mcubed-lineup-insight-server -p 80`. The arguments for the command line interface are:

* *-p / --port* - **Optional.** Specifies the port on which to run the lineup insight server. This will default to 8000.
* *--persistenceServer* - **Optional.** Defines the server name or IP address that is running mcubed-persistence. Refer to the [mcubed-persistence](#mcubed-persistence) section. All 4 persistence options must be specified to enable the persistence feature.
* *--persistencePort* - **Optional.** Defines the port that mcubed-persistence is running on. Refer to the [mcubed-persistence](#mcubed-persistence) section. All 4 persistence options must be specified to enable the persistence feature.
* *--persistenceAppName* - **Optional.** Defines the application name configured with the running mcubed-persistence. Refer to the [mcubed-persistence](#mcubed-persistence) section. All 4 persistence options must be specified to enable the persistence feature.
* *--persistenceAppKey* - **Optional.** Defines the application key generated by the running mcubed-persistence. Refer to the [mcubed-persistence](#mcubed-persistence) section. All 4 persistence options must be specified to enable the persistence feature.

<a name="mcubed-persistence"></a>
[mcubed-persistence](https://github.com/nickp10/mcubed-persistence)
----
The mcubed-persistence module is used to store alternate and missing names when merging the fantasy sports data. Different third-parties refer to the same player with slight variations in the name. Alternate names are used to map these variations to the players defined in the contests. Missing names are used to store those names that cannot match a player defined in the contests. To enable these two features, all 4 persistence options must be specified on the CLI. Refer to the mcubed-persistence documentation on how to obtain the application name and key. The table names used by this module are:

* lineupalternatenames - Stores the mapping between a third-party player name and the corresponding contest name.
* lineupmissingnames - Stores the names that cannot be mapped to a corresponding contest name.

Accessing the Data
----
Accessing the data is done using the read operation via the RESTful GET verb. The URL to the data will be:

`http://{server-name}:{server-port}/{contest-id}/{player-id}`

* *server-name* - **Required.** Indicates the server name or IP address on which the lineup insight server is running.
* *server-port* - **Required.** Indicates the server port on which the lineup insight server is running.
* *contest-id* - **Optional.** If specified, *player-id* becomes required. Indicates the ID of the contest to retrieve a player card for.
* *player-id* - **Optional.** If specified, *contest-id* becomes required. Indicates the ID of the player to retrieve a player card for.

The HTTP endpoints that are exposed are:

* *GET /* - Retrieves the contest list and all corresponding insight data. This will return a [Contest](https://github.com/nickp10/mcubed-lineup-insight-data#Contest)[].
* *GET /{contest-id}/{player-id}* - Retrieves the player card for a single player. This will return a [PlayerCard](https://github.com/nickp10/mcubed-lineup-insight-data#PlayerCard).

API / ServerPlayer
----
The data returned via the HTTP server follows the same API as defined by [mcubed-lineup-insight-data](https://github.com/nickp10/mcubed-lineup-insight-data#InsightData). The only difference is that this module adds more properties to the [Player](https://github.com/nickp10/mcubed-lineup-insight-data#Player) class.

#### <a name="ServerPlayer"></a>ServerPlayer
Instances of this class are extensions of the [Player](https://github.com/nickp10/mcubed-lineup-insight-data#Player class.

* `isPlaying?: boolean` - Optionally specifies a single boolean that combines if a player is starting or is the probable pitcher (i.e., `isPlaying === isStarter || isProbablePitcher`).
* `likeability?: number` - Optionally specifies a single number between 0 and 100 determining how much the lineup insight server likes the player (0 indicates hate and 100 indicates love).
* `projectedPointsPerDollar?: number` - Optionally specifies a number that indicates how many points the player is projected per dollar (based on salary).
* `projectedCeiling?: number` - Optionally specifies a number that indicates the most number of points the player is projected to obtain.
* `projectedFloor?: number` - Optionally specifies a number that indicates the least number of points the player is projected to obtain.
* `projectedPoints?: number` - Optionally specifies a number that indicates the likely number of points the player is projected to obtain.
* `recentAveragePoints?: number` - Optionally specifies a number that indicates the average number of points the player has scored recently.
* `seasonAveragePoints?: number` - Optionally specifies a number that indicates the average number of points the player has scored on the season.
